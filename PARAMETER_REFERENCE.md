# 📊 Bitcoin Puzzle 135 System - 参数参考手册

## 📋 目录
- [Bernstein-Lange算法参数](#bernstein-lange算法参数)
- [程序特定参数](#程序特定参数)
- [性能调优参数](#性能调优参数)
- [推荐配置](#推荐配置)
- [参数计算公式](#参数计算公式)

---

## 🔬 Bernstein-Lange算法参数

### 核心参数说明

#### **L (搜索范围大小)**
- **定义**: 搜索范围为 2^L
- **取值范围**: 20-67
- **影响**: 直接决定搜索空间大小
- **示例**:
  ```
  L=20: 搜索范围 2^20 = 1,048,576
  L=30: 搜索范围 2^30 = 1,073,741,824
  L=40: 搜索范围 2^40 = 1,099,511,627,776
  L=67: 搜索范围 2^67 (Bitcoin Puzzle 135)
  ```

#### **T (预计算表大小)**
- **定义**: 预计算表中存储的点数量
- **取值范围**: 1024-65536
- **影响**: 内存使用量和碰撞概率
- **计算**: 表格文件大小 ≈ T × 104 bytes
- **示例**:
  ```
  T=1024:  表格大小 ≈ 106KB
  T=4096:  表格大小 ≈ 416KB
  T=8192:  表格大小 ≈ 832KB
  T=65536: 表格大小 ≈ 6.8MB
  ```

#### **W (权重参数)**
- **定义**: 理论最优步数期望值
- **计算公式**: W = α × √(L/T)，其中 α ≈ 1.33
- **自动计算**: 程序自动根据L和T计算
- **示例**:
  ```
  L=20, T=1024:  W ≈ 43
  L=30, T=4096:  W ≈ 681
  L=40, T=8192:  W ≈ 15408
  ```

#### **DP_MASK_BITS (Distinguished Point掩码位数)**
- **定义**: 控制Distinguished Point检测概率
- **取值范围**: 3-12
- **概率**: 1/2^DP_MASK_BITS
- **推荐值**: 3 (概率 1/8 ≈ 12.5%)
- **影响**: 碰撞检测频率和内存使用

---

## 🎮 程序特定参数

### 1. kangaroo.exe 参数

#### 基本参数
```bash
kangaroo.exe [options] <public_key>
```

| 参数 | 说明 | 默认值 | 示例 |
|------|------|--------|------|
| `-t <threads>` | GPU线程数 | 自动检测 | `-t 1024` |
| `-g <gpu_id>` | GPU设备ID | 0 | `-g 1` |
| `-w <work_file>` | 工作文件路径 | work.txt | `-w puzzle135.work` |
| `-s <start>` | 搜索起始范围 | 1 | `-s 4000000000000000000000000000000000` |
| `-e <end>` | 搜索结束范围 | 2^256-1 | `-e 7fffffffffffffffffffffffffffffffff` |

#### 高级参数
| 参数 | 说明 | 默认值 | 示例 |
|------|------|--------|------|
| `-dp <bits>` | DP掩码位数 | 10 | `-dp 8` |
| `-k <kangaroos>` | Kangaroo数量 | GPU核心数 | `-k 2048` |
| `-check <interval>` | 检查间隔(秒) | 60 | `-check 30` |

### 2. puzzle135_challenge.exe 参数

```bash
puzzle135_challenge.exe <precompute_table> <max_steps>
```

| 参数 | 说明 | 示例 |
|------|------|------|
| `<precompute_table>` | 预计算表文件路径 | `puzzle135_bl_table.bin` |
| `<max_steps>` | 最大搜索步数 | `1000000000` |

### 3. puzzle135_bl_generator.exe 参数

```bash
puzzle135_bl_generator.exe <L> <T> <output_file>
```

| 参数 | 说明 | 示例 |
|------|------|------|
| `<L>` | 搜索范围大小(2^L) | `40` |
| `<T>` | 表格大小 | `8192` |
| `<output_file>` | 输出文件路径 | `puzzle135_table.bin` |

### 4. generate_bl_real_ec_table.exe 参数

```bash
generate_bl_real_ec_table.exe <L> <T> <output_file>
```

| 参数 | 说明 | 示例 |
|------|------|------|
| `<L>` | 搜索范围大小(2^L) | `30` |
| `<T>` | 表格大小 | `4096` |
| `<output_file>` | 输出文件路径 | `real_ec_table.bin` |

---

## ⚡ 性能调优参数

### GPU相关参数

#### **线程数配置**
- **计算公式**: 线程数 = GPU核心数 × 倍数
- **推荐倍数**: 2-4倍
- **示例**:
  ```
  RTX 3080 (8704核心): 线程数 = 8704 × 2 = 17408
  RTX 4090 (16384核心): 线程数 = 16384 × 3 = 49152
  ```

#### **内存使用优化**
- **表格内存**: T × 104 bytes
- **GPU内存**: 线程数 × 256 bytes
- **系统内存**: 建议 ≥ 表格大小 × 2

### 算法参数优化

#### **L和T的平衡**
- **原则**: 保持 W = α × √(L/T) 在合理范围
- **推荐W范围**: 100-50000
- **计算示例**:
  ```
  目标L=40, 期望W=15000:
  T = L / (W/α)² = 40 / (15000/1.33)² ≈ 8192
  ```

#### **DP掩码位数选择**
- **高频率**: dp_mask_bits=3 (12.5%概率)
- **中频率**: dp_mask_bits=4 (6.25%概率)
- **低频率**: dp_mask_bits=8 (0.39%概率)

---

## 🎯 推荐配置

### 测试环境配置
```bash
# 小规模测试 (几分钟完成)
L=20, T=1024, max_steps=1000000
表格大小: 106KB, 内存需求: <1GB

# 中等规模测试 (几小时完成)
L=30, T=4096, max_steps=100000000
表格大小: 416KB, 内存需求: 2-4GB
```

### 生产环境配置
```bash
# Bitcoin Puzzle 135 (理论配置)
L=67, T=65536, max_steps=无限制
表格大小: 6.8MB, 内存需求: 16GB+

# 实际可行配置 (较小范围)
L=40, T=8192, max_steps=10000000000
表格大小: 832KB, 内存需求: 8GB
```

### 硬件特定配置

#### **RTX 3080配置**
```bash
线程数: 17408
GPU内存: 10GB
推荐配置: L=40, T=8192, threads=16384
```

#### **RTX 4090配置**
```bash
线程数: 49152
GPU内存: 24GB
推荐配置: L=45, T=16384, threads=32768
```

---

## 📐 参数计算公式

### 理论公式

#### **期望步数计算**
```
E[steps] = W = α × √(π × L / (2 × T))
其中: α ≈ 1.33 (经验常数)
```

#### **碰撞概率计算**
```
P(collision) = 1 - exp(-steps² / (2 × 2^L))
```

#### **内存使用计算**
```
表格内存 = T × 104 bytes
GPU内存 = threads × 256 bytes
总内存 = 表格内存 + GPU内存 + 系统开销
```

### 实用计算器

#### **给定L和T，计算W**
```python
import math
def calculate_W(L, T):
    alpha = 1.33
    return alpha * math.sqrt(math.pi * L / (2 * T))
```

#### **给定L和期望W，计算T**
```python
def calculate_T(L, target_W):
    alpha = 1.33
    return math.pi * L / (2 * (target_W / alpha) ** 2)
```

#### **估算完成时间**
```python
def estimate_time(L, steps_per_second):
    expected_steps = 2 ** (L/2)
    return expected_steps / steps_per_second
```

---

## 🔧 调试参数

### 日志级别
- **0**: 仅错误信息
- **1**: 基本信息
- **2**: 详细信息
- **3**: 调试信息

### 检查点间隔
- **快速测试**: 10秒
- **正常运行**: 60秒
- **长期运行**: 300秒

### 输出格式
- **简洁模式**: 仅显示关键信息
- **详细模式**: 显示所有统计信息
- **调试模式**: 显示内部状态

---

**📚 此参考手册涵盖了所有重要参数的详细说明，请根据您的硬件配置和需求选择合适的参数组合。**
